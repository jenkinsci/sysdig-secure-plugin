package com.sysdig.jenkins.plugins.sysdig.application.ui.report;

import com.google.gson.JsonElement;
import com.google.gson.JsonParser;
import com.sysdig.jenkins.plugins.sysdig.TestMother;
import com.sysdig.jenkins.plugins.sysdig.application.vm.report.VulnerabilityReportProcessor;
import com.sysdig.jenkins.plugins.sysdig.domain.vm.ImageScanningResult;
import com.sysdig.jenkins.plugins.sysdig.domain.vm.report.Result;
import com.sysdig.jenkins.plugins.sysdig.infrastructure.json.GsonBuilder;
import org.apache.commons.io.IOUtils;
import org.junit.jupiter.api.Test;

import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.util.Objects;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class VulnerabilityReportProcessorTest {
  @Test
  public void testPolicyEvaluationSummaryIsGeneratedCorrectly() throws IOException {
    // Given
    var result = TestMother.rawScanResult();
    var imageScanningResult = ImageScanningResult.fromReportResult(result);

    // When
    var vulnerabilityReport = VulnerabilityReportProcessor.generateVulnerabilityReport(imageScanningResult);

    // Then
    JsonElement expectedJson = JsonParser.parseString("{" +
      "\"columns\":[" +
      "{\"title\":\"Tag\"}," +
      "{\"title\":\"CVE ID\"}," +
      "{\"title\":\"Severity\"}," +
      "{\"title\":\"Vulnerability Package\"}," +
      "{\"title\":\"Fix Available\"}," +
      "{\"title\":\"URL\"}," +
      "{\"title\":\"Package Type\"}," +
      "{\"title\":\"Package Path\"}," +
      "{\"title\":\"Disclosure Date\"}," +
      "{\"title\":\"Solution Date\"}" +
      "]," +
      "\"data\":[" +
      "[\"nginx\",\"CVE-2011-3374\",\"Negligible\",\"apt\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2011-09-22\",\"None\"]," +
      "[\"nginx\",\"CVE-2022-0563\",\"Negligible\",\"bsdutils\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-02-14\",\"None\"]," +
      "[\"nginx\",\"CVE-2016-2781\",\"Low\",\"coreutils\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2016-02-28\",\"None\"]," +
      "[\"nginx\",\"CVE-2017-18018\",\"Negligible\",\"coreutils\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2017-12-20\",\"None\"]," +
      "[\"nginx\",\"CVE-2022-27943\",\"Negligible\",\"gcc-12-base\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-03-23\",\"None\"]," +
      "[\"nginx\",\"CVE-2023-4039\",\"Medium\",\"gcc-12-base\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-09-12\",\"None\"]," +
      "[\"nginx\",\"CVE-2022-3219\",\"Negligible\",\"gpgv\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-05-22\",\"None\"]," +
      "[\"nginx\",\"CVE-2011-3374\",\"Negligible\",\"libapt-pkg6.0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2011-09-22\",\"None\"]," +
      "[\"nginx\",\"CVE-2022-0563\",\"Negligible\",\"libblkid1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-02-14\",\"None\"]," +
      "[\"nginx\",\"CVE-2019-9192\",\"Negligible\",\"libc-bin\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2019-02-26\",\"None\"]," +
      "[\"nginx\",\"CVE-2019-1010024\",\"Negligible\",\"libc-bin\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-02-16\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-1010022\",\"Negligible\",\"libc-bin\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2013-06-02\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-1010023\",\"Negligible\",\"libc-bin\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-02-16\",\"None\"]" +
      ",[\"nginx\",\"CVE-2010-4756\",\"Negligible\",\"libc-bin\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2010-10-07\",\"None\"]" +
      ",[\"nginx\",\"CVE-2018-20796\",\"Negligible\",\"libc-bin\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-09-12\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-1010025\",\"Negligible\",\"libc-bin\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-02-16\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-9192\",\"Negligible\",\"libc6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2019-02-26\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-1010024\",\"Negligible\",\"libc6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-02-16\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-1010022\",\"Negligible\",\"libc6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2013-06-02\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-1010023\",\"Negligible\",\"libc6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-02-16\",\"None\"]" +
      ",[\"nginx\",\"CVE-2010-4756\",\"Negligible\",\"libc6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2010-10-07\",\"None\"]" +
      ",[\"nginx\",\"CVE-2018-20796\",\"Negligible\",\"libc6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-09-12\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-1010025\",\"Negligible\",\"libc6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-02-16\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-27943\",\"Negligible\",\"libgcc-s1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-03-23\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-4039\",\"Medium\",\"libgcc-s1\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-09-12\",\"None\"]" +
      ",[\"nginx\",\"CVE-2018-6829\",\"Negligible\",\"libgcrypt20\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-02-01\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-2236\",\"Medium\",\"libgcrypt20\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-03-05\",\"None\"]" +
      ",[\"nginx\",\"CVE-2011-3389\",\"Negligible\",\"libgnutls30\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2011-08-31\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-0563\",\"Negligible\",\"libmount1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-02-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-22365\",\"Medium\",\"libpam-modules\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2024-01-17\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-22365\",\"Medium\",\"libpam-modules-bin\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2024-01-17\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-22365\",\"Medium\",\"libpam-runtime\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2024-01-17\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-22365\",\"Medium\",\"libpam0g\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2024-01-17\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-0563\",\"Negligible\",\"libsmartcols1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-02-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-27943\",\"Negligible\",\"libstdc++6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-03-23\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-4039\",\"Medium\",\"libstdc++6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-09-12\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-31439\",\"Negligible\",\"libsystemd0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-09\",\"None\"]" +
      ",[\"nginx\",\"CVE-2013-4392\",\"Negligible\",\"libsystemd0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2012-09-20\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-31437\",\"Negligible\",\"libsystemd0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-09\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-31438\",\"Negligible\",\"libsystemd0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-09\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-50495\",\"Medium\",\"libtinfo6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-04-23\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-45918\",\"Negligible\",\"libtinfo6\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-31439\",\"Negligible\",\"libudev1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-09\",\"None\"]" +
      ",[\"nginx\",\"CVE-2013-4392\",\"Negligible\",\"libudev1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2012-09-20\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-31437\",\"Negligible\",\"libudev1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-09\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-31438\",\"Negligible\",\"libudev1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-09\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-0563\",\"Negligible\",\"libuuid1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-02-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-4641\",\"Medium\",\"login\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-19\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-19882\",\"Negligible\",\"login\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2019-12-07\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-29383\",\"Low\",\"login\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-03-30\",\"None\"]" +
      ",[\"nginx\",\"CVE-2007-5686\",\"Negligible\",\"login\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2007-10-11\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-0563\",\"Negligible\",\"mount\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-02-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-50495\",\"Medium\",\"ncurses-base\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-04-23\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-45918\",\"Negligible\",\"ncurses-base\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-50495\",\"Medium\",\"ncurses-bin\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-04-23\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-45918\",\"Negligible\",\"ncurses-bin\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-4641\",\"Medium\",\"passwd\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-06-19\",\"None\"]" +
      ",[\"nginx\",\"CVE-2019-19882\",\"Negligible\",\"passwd\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2019-12-07\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-29383\",\"Low\",\"passwd\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-03-30\",\"None\"]" +
      ",[\"nginx\",\"CVE-2007-5686\",\"Negligible\",\"passwd\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2007-10-11\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-31484\",\"High\",\"perl-base\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-02-28\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-31486\",\"Negligible\",\"perl-base\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-02-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2011-4116\",\"Negligible\",\"perl-base\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2011-06-27\",\"None\"]" +
      ",[\"nginx\",\"CVE-2005-2541\",\"Negligible\",\"tar\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2005-08-04\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-0563\",\"Negligible\",\"util-linux\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-02-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-0563\",\"Negligible\",\"util-linux-extra\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-02-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-45853\",\"Critical\",\"zlib1g\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-08-11\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-2379\",\"Negligible\",\"curl\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2024-03-12\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-8096\",\"Low\",\"curl\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-08-22\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-39616\",\"High\",\"libaom3\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-01-27\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-6879\",\"Critical\",\"libaom3\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-12-28\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-2379\",\"Negligible\",\"libcurl4\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2024-03-12\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-8096\",\"Low\",\"libcurl4\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-08-22\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-32570\",\"Medium\",\"libdav1d6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-02-01\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-51792\",\"High\",\"libde265-0\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2023-11-03\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-38950\",\"High\",\"libde265-0\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-06-10\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-38949\",\"High\",\"libde265-0\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-06-10\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-45491\",\"Critical\",\"libexpat1\",\"2.5.0-1+deb12u1\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2024-08-26\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-45492\",\"Critical\",\"libexpat1\",\"2.5.0-1+deb12u1\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2024-08-26\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-45490\",\"Critical\",\"libexpat1\",\"2.5.0-1+deb12u1\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2024-08-26\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-52425\",\"High\",\"libexpat1\",\"2.5.0-1+deb12u1\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-11-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-52426\",\"Negligible\",\"libexpat1\",\"2.5.0-1+deb12u1\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-11-06\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-28757\",\"Negligible\",\"libexpat1\",\"2.5.0-1+deb12u1\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2024-03-03\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26458\",\"Negligible\",\"libgssapi-krb5-2\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26462\",\"Negligible\",\"libgssapi-krb5-2\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2018-5709\",\"Negligible\",\"libgssapi-krb5-2\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-01-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26461\",\"Negligible\",\"libgssapi-krb5-2\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-25269\",\"Negligible\",\"libheif1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-12-21\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-29659\",\"Medium\",\"libheif1\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-03-06\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-49462\",\"High\",\"libheif1\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-11-22\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-49463\",\"Negligible\",\"libheif1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-11-22\",\"None\"]" +
      ",[\"nginx\",\"CVE-2017-9937\",\"Negligible\",\"libjbig0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2017-06-26\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26458\",\"Negligible\",\"libk5crypto3\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26462\",\"Negligible\",\"libk5crypto3\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2018-5709\",\"Negligible\",\"libk5crypto3\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-01-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26461\",\"Negligible\",\"libk5crypto3\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26458\",\"Negligible\",\"libkrb5-3\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26462\",\"Negligible\",\"libkrb5-3\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2018-5709\",\"Negligible\",\"libkrb5-3\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-01-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26461\",\"Negligible\",\"libkrb5-3\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26458\",\"Negligible\",\"libkrb5support0\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26462\",\"Negligible\",\"libkrb5support0\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2018-5709\",\"Negligible\",\"libkrb5support0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-01-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-26461\",\"Negligible\",\"libkrb5support0\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2015-3276\",\"Negligible\",\"libldap-2.5-0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2015-07-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2017-17740\",\"Negligible\",\"libldap-2.5-0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2017-10-20\",\"None\"]" +
      ",[\"nginx\",\"CVE-2017-14159\",\"Negligible\",\"libldap-2.5-0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2017-07-28\",\"None\"]" +
      ",[\"nginx\",\"CVE-2020-15719\",\"Negligible\",\"libldap-2.5-0\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2019-08-12\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-2953\",\"High\",\"libldap-2.5-0\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2022-08-24\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-28182\",\"Medium\",\"libnghttp2-14\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-04-03\",\"None\"]" +
      ",[\"nginx\",\"CVE-2021-4214\",\"Negligible\",\"libpng16-16\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2019-06-25\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-5535\",\"High\",\"libssl3\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-06-27\",\"None\"]" +
      ",[\"nginx\",\"CVE-2018-10126\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2018-04-18\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-3618\",\"Medium\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-02-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-25433\",\"Medium\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-01-27\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-1916\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-03-18\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-26965\",\"Medium\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-02-09\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-6228\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-09-07\",\"None\"]" +
      ",[\"nginx\",\"CVE-2022-1210\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2022-04-02\",\"None\"]" +
      ",[\"nginx\",\"CVE-2017-17973\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2017-12-29\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-26966\",\"Medium\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-02-15\",\"None\"]" +
      ",[\"nginx\",\"CVE-2017-9117\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2016-04-07\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-3164\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-03-18\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-52355\",\"High\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-10-08\",\"None\"]" +
      ",[\"nginx\",\"CVE-2017-16232\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2017-10-31\",\"None\"]" +
      ",[\"nginx\",\"CVE-2017-5563\",\"Negligible\",\"libtiff6\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2016-04-07\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-52356\",\"High\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-10-31\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-2908\",\"Medium\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-04-20\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-6277\",\"Medium\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-10-08\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-7006\",\"High\",\"libtiff6\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-11-23\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-45322\",\"Medium\",\"libxml2\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"1999-01-01\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-25062\",\"High\",\"libxml2\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-10-13\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-34459\",\"Negligible\",\"libxml2\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2024-05-13\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-39615\",\"Medium\",\"libxml2\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2023-05-06\",\"None\"]" +
      ",[\"nginx\",\"CVE-2015-9019\",\"Negligible\",\"libxslt1.1\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2015-11-20\",\"None\"]" +
      ",[\"nginx\",\"CVE-2009-4487\",\"Negligible\",\"nginx\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2010-01-10\",\"None\"]" +
      ",[\"nginx\",\"CVE-2013-0337\",\"Low\",\"nginx\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2013-02-22\",\"None\"]" +
      ",[\"nginx\",\"CVE-2023-44487\",\"Negligible\",\"nginx\",\"None\",\"debian\",\"os\",\"/var/lib/dpkg/status\",\"2023-10-10\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-7347\",\"Medium\",\"nginx\",\"None\",\"nvd\",\"os\",\"/var/lib/dpkg/status\",\"2024-08-14\",\"None\"]" +
      ",[\"nginx\",\"CVE-2024-5535\",\"High\",\"openssl\",\"None\",\"vulndb\",\"os\",\"/var/lib/dpkg/status\",\"2024-06-27\",\"None\"]" +
      "]}");
    assertEquals(expectedJson, vulnerabilityReport);
  }
}
